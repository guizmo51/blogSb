<!DOCTYPE html>
  <html>
    <head>
    <title>MapBoostadopt - http://www.simonblum.me/</title>
      
             
      <link type="text/css" rel="stylesheet" href="/css/style.css"  media="screen,projection"/>

      <link type="text/css" rel="stylesheet" href="/css/materialize.min.css"  media="screen,projection"/>
      <link type="text/css" rel="stylesheet" href="/css/custom.css"  media="screen,projection"/>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>

      
      
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
      <meta charset="UTF-8" />
      <meta name="description" content="Simon BLUM, 27 ans, ingénieur Web utilisant les technologies PHP et NodeJS. " />
    </head>
<body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/fr_FR/sdk.js#xfbml=1&version=v2.4";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<nav>
    <div class="nav-wrapper">
      <a href="http://www.simonblum.me" class="brand-logo">Simon Blum</a>
       <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>

     	<ul id="nav-mobile" class="right hide-on-med-and-down">

	
	 <li><a href="http://www.simonblum.me//post/qui-suis-je/">Qui suis-je ?</a></li>
       <li><a href="http://www.simonblum.me//post/pourquoi-ce-blog/">Pourquoi ce blog ?</a></li>
                    <li><a href="http://www.simonblum.me//categories/retour-dexperience/">Retour d'expérience</a></li>
                    <li><a href="http://www.simonblum.me//categories/hacks/">Hacks</a></li>
                    <li><a href="http://www.simonblum.me//categories/hors-sujet/">Hors-sujet..</a></li>
                     <li><a href="#contact">Contact</a></li>
                    <li><a href="http://www.simonblum.me//cv">mon CV</a></li>
</ul>
<ul class="side-nav" id="mobile-demo">
      <li><a href="http://www.simonblum.me//post/qui-suis-je/">Qui suis-je ?</a></li>
       <li><a href="http://www.simonblum.me//post/pourquoi-ce-blog/">Pourquoi ce blog ?</a></li>
                    <li><a href="http://www.simonblum.me//categories/retour-dexperience/">Retour d'expérience</a></li>
                    <li><a href="http://www.simonblum.me//categories/hacks/">Hacks</a></li>
                    <li><a href="http://www.simonblum.me//categories/hors-sujet/">Hors-sujet..</a></li>
                     <li><a href="#contact">Contact</a></li>
                    <li><a href="http://www.simonblum.me//cv">mon CV</a></li>
		</ul>
    
    </div>
  </nav>
       

<div class="container">
    <div class="row">
        <div class="col-md-9">
            <div class="well well-sm">
                    <h2>MapBoostadopt<br> <small></small></h2>
                    <hr>
                     August 8, 2015
                      - <a href="/categories/retour-dexperience ">retour d&#39;experience</a> -
                     <div class="fb-share-button" data-href="http://www.simonblum.me/post/retourdexperience/mapboostadopt/" data-layout="icon_link"></div>

                      



                     <br>
                    <hr>
                    <p>Comme vous avez pu le <a href="http://www.simonblum.me/post/retourdexperience/boostadopt/" target="_blank">lire précèdemment</a> j&rsquo;ai réalisé un projet de &ldquo;booster&rdquo; (permettant d&rsquo;améliorer l&rsquo;efficacité) pour le site de rencontre AdopteUnMec.com .</p>

<p>Lors de mes expérimentations (afin de trouver une solution viable) j&rsquo;ai agrégé une masse conséquente de profils dans le but de les analyser et les exploiter dans le futur. En effet, le booster fonctionne en visitant un profil (donc en récupérant ses informations) autant enregistrer ce profil pour une utilisation ultérieure.</p>

<p>Etant fan des big data et de cartographie j&rsquo;ai donc souhaité mettre en place une grande carte interactive des profils d&rsquo;AdopteUnMec. Suite à une mise en demeure ce projet a été désactivé. Il n&rsquo;est malheureusement plus possible de le visualiser. Ce projet se voulait comme un outil pour faire du &ldquo;buzz&rdquo; autour des aspects &ldquo;données&rdquo; et &ldquo;cartographie&rdquo; afin de communiquer sur BoostAdopt.</p>

<p>Voici une capture d'écran du projet MapBoostAdopt.
J'ai souhaité mettre en place une interface légère avec comme fond (sur tout l'écran) une carte interactive utilisant OpenStreetMap. Par dessus j'ai rajouté un champ de recherche par ville et aussi 5 profils d'invidus géographiquement présent sur la carte visible. Bien sûr si l'on zoomait sur une zone ces résultats étaient mis à jour. Sur cette capture d'écran on peut voir que des utilisateurs provenant de France, Suisse, Luxembourg, Belgique sont présents. Suite à l'ouverture du site italien et du site allemand j'ai aussi pu enregistrer des profils provenant de ces 2 nouveaux pays.  
<img src="/images/boostadopt.png" /></p>

<p><h3>Coin technique</h3>
 Les profils retournés par l&rsquo;API sont des documents JSON ayant des formats variés, en effet un profil complet aura 100% des attributs remplis. Au contraire quelqu&rsquo;un n&rsquo;ayant rempli que le strict minimum n&rsquo;aura que très peu d&rsquo;attributs de retournés par l&rsquo;API. Ce format étant varié j&rsquo;ai donc choisi MongoDB qui est de type NoSQL pour gèrer le stockage de ces profils. Enfin MongoDB retourne directement un document JSON, je n&rsquo;ai pas à demander à NodeJS de gèrer cela.</p>

<p><style type="text/css">
  .gist {width:500px !important;}
  .gist-file
  .gist-data {max-height: 500px;max-width: 500px;}
</style>
<p>Exemple d&rsquo;un JSON retourné par l&rsquo;API d&rsquo;AdopteUnMec.com</p>
 <script src="https://gist.github.com/guizmo51/4095f94900b4918ec6f3.js"></script></p>

<p>Alors que l&rsquo;agrégation des profils se faisait dans le projet &ldquo;boostAdopt&rdquo; en PHP, j&rsquo;ai mis en place une API en utilisant ExpressJS (qui est un framework NodeJS)</p>

<p>Le front utilise jQuery, boostrap et pour le côté cartographie j&rsquo;ai utilisé MapQuest fournissant une cartographie OpenStreetMap ou Google Maps au choix. MapQuest fournit également un accès à ses API pour, par exemple, obtenir les coordonnées GPS du centre d&rsquo;une ville.</p>

<p><h3>Législation</h3></p>

<p>Les données sont importantes celles qui sont personnelles ne peuvent être diffusées comme cela. J&rsquo;ai donc analysé pendant plusieurs semaines les mentions légales, CGU et CGV du site AdopteUnMec.com. Les données personnelles (email, nom, prénom, etc) ne sont pas présentes dans les JSON générés par l&rsquo;API AdopteUnmec. La seule contrainte est de s&rsquo;assurer qu&rsquo;uniquement des utilisateurs d&rsquo;AdopteUnMec accèdent à ces données. J&rsquo;ai donc mis en place une popin de confirmation (un peu comme celles demandant si un internaute est bien majeur sur certains sites). Chacun jugera de l&rsquo;efficacité de ce système&hellip;</p>

<p><h3> Déroulement du projet</h3>
Initialement le projet n&rsquo;enregistrait que la fiche d&rsquo;un individu : la localisation ne correspondait qu&rsquo;à un champs portant le nom de la ville du membre. En France plusieurs villes ont le même nom, de plus certans membres renseignaient des villes à l&rsquo;orthographe incorrecte. J&rsquo;ai dû revoir en partie l&rsquo;agréagation des données afin de sauvegarder le pays, la région mais aussi le département du membre.</p>

<p>MapQuest fournissant des API retournant les coordonées GPS d&rsquo;un point géographie comme une ville, j&rsquo;ai ensuite associé chaque ville à des coordonnées GPS. Enfin il ne me restait plus qu&rsquo;à associer la ville du profil à ce tableau de coordonnées.</p>

<p>Enfin pour l&rsquo;affichage j&rsquo;ai choisi la librairie leaflet permettant de représenter des clusters de marqueurs géographiques.
Dans les faits je place plusieurs milliers de marqueurs sur ma carte OpenStreetMap mais afin de la rendre lisible leaflet les affiche sont forme de cluster en indiquant le nombre de marqueur que ça représente. C&rsquo;est la représentation la plus lisible possible.</p>

<p>NodeJS : lors de la mise en production et des premiers tests de montée en charge je me suis rendu compte que &ldquo;forever&rdquo; de NodeJS se met parfois à &ldquo;déconner&rdquo;. Il fait monter la charge du serveur à 95 ou 98% de CPU &hellip; ce bug était connu à l&rsquo;époque.</p>

            </div>
        </div>
    </div>
 <div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'simonb';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        <footer>
            <div class="row">
                <hr>
                <div class="col-sm-12">
                    <p>&copy; Simon Blum 2015<br>
                    Built with <a href="https://github.com/spf13/hugo">Hugo</a></p>
                </div>
            </div>
        </footer>
</div>
       <footer class="page-footer">
          <div class="container">
            <div class="row">
              <div class="col l4 s4">
                <h5 class="white-text">SimonBlum.me</h5>
                <p class="grey-text text-lighten-4"></p>
              </div>
              <div class="col l4  s4">
                <h5 class="white-text">Derniers contenus</h5>
                <ul>
                  
                     <li><a class="grey-text text-lighten-3" href="/post/retourdexperience/mapboostadopt/"><i class="mdi-navigation-chevron-right"></i>MapBoostadopt</a></li>
                  
                     <li><a class="grey-text text-lighten-3" href="/post/hacks/concours-facebook/"><i class="mdi-navigation-chevron-right"></i>Concours Facebook</a></li>
                  
                     <li><a class="grey-text text-lighten-3" href="/post/retourdexperience/boostadopt/"><i class="mdi-navigation-chevron-right"></i>Boostadopt</a></li>
                  
                     <li><a class="grey-text text-lighten-3" href="/post/hors-sujets/stadedefrance/"><i class="mdi-navigation-chevron-right"></i>J&#39;ai couru un 100m au Stade de France devant 50.000 spectateurs</a></li>
                  
                     <li><a class="grey-text text-lighten-3" href="/post/pourquoi-ce-blog/"><i class="mdi-navigation-chevron-right"></i>Pourquoi ce blog ?</a></li>
                  
                </ul>
              </div>
              <div class="col l4 s4">
                <h5 class="white-text" id="contact">Contact</h5>
                <ul>
                    <li><a class="grey-text text-lighten-3" href="mailto:contact@simonblum.me">Email</a></li>
                     <li><a class="grey-text text-lighten-3" href="http://www.twitter.com/sim51100">Twitter</a></li>
                        <li><a class="grey-text text-lighten-3" href="https://fr.linkedin.com/pub/simon-blum/6b/39b/355">LinkedIn</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="footer-copyright">
            <div class="container">
            © 2015 Simon Blum

            </div>
          </div>
        </footer>
            
      <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
      <script type="text/javascript" src="/js/materialize.min.js"></script>
       <script type="text/javascript" src="/js/init.js"></script>
       <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-65523215-1', 'auto');
  ga('send', 'pageview');

</script>
    </body>
  </html>


